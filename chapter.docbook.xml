<?xml version="1.0" encoding="UTF-8"?>
<!-- $Id: chapter.docbook.xml 611 2013-06-05 07:27:35Z netkiller $ -->
<part id="index"><?dbhtml dir="docbook" ?>
	<title>Docbook</title>
	<para><ulink url="http://www.docbook.org/">http://www.docbook.org/</ulink></para>
	<para>http://docbook.org/tdg51/en/html/docbook.html</para>
	<chapter id="license">
		<title>Open Document Licenses</title>
	 	<para>Creative Commons Attribution 3.0</para><!-- http://creativecommons.org/about/downloads -->
		<para>GNU Free Documentation License</para>
		<para>Open Publication License</para>
		<para>The FreeBSD Documentation License</para>
	</chapter>

<chapter id="docbook.tools">
	<title>Document Tools</title>
	<para>Docbook SGML,XML 转换程序</para>
	<section id="docbook-utils">
		<title>SGML</title>
		<screen>
sudo apt-get install docbook-utils
		</screen>
		<para>CentOS</para>
		<screen>
# yum install docbook*
		</screen>
	</section>
	<section id="docbook-xml">
		<title>XML 转换</title>
		<para>docbook-xsl-1.73.2.tar.gz</para>
		<para>docbook-dsssl-1.79.tar.gz</para>
		<para>rxp - A validating XML parser</para>
		<para>rxp -s file.xml</para>
		<para>To validate file.xml, use the command:</para>
		<para>$ rxp -s -V file.xml</para>
		<section id="xsltproc">
			<title>xsltproc - XSLT command line processor</title>
			<para>xsltproc --stringparam html.stylesheet docbook.css ../../docbook-xsl-1.73.2/xhtml/chunk.xsl ../book.xml</para>
			<screen>
$ sudo apt-get install docbook-xsl
$ export DSSSL=/usr/share/xml/docbook/stylesheet/nwalsh/xhtml/chunk.xsl
$ /usr/bin/xsltproc --stringparam html.stylesheet docbook.css ${DSSSL} ../book.xml

			</screen>
		</section>
		<section id="docbook-ebnf">
			<title>docbook-ebnf - EBNF module for the XML version of the DocBook DTD</title>
			<para>docbook-ebnf - EBNF module for the XML version of the DocBook DTD</para>
			<screen>
$ sudo apt-get install docbook-ebnf
			</screen>
		</section>
		<section id="docbook-xsl-saxon">
			<title>docbook-xsl-saxon</title>
			<screen>
$ sudo apt-get install docbook-xsl-saxon
			</screen>
			<para>创建一个test.xml的测试文件</para>
			<screen>
			<![CDATA[
SRCS = test.xml

DESTDIR = .

all: html

html: $(SRCS:.xml=.noext.html) $(SRCS:.xml=.html)

%.png : %.png.uu
	[ -d ${DESTDIR} ] || mkdir -p ${DESTDIR}
	uudecode -o /dev/stdout < $< > ${DESTDIR}/$@

%.html : %.xml
	[ -d ${DESTDIR} ] || mkdir -p ${DESTDIR}
	java -cp "/usr/share/java/saxon.jar:/usr/share/java/xslthl.jar:/usr/share/java/docbook-xsl-saxon.jar" \
	  -Dhighlight.xslthl.config="/usr/share/xml/docbook/stylesheet/docbook-xsl/highlighting/xslthl-config.xml" \
	  com.icl.saxon.StyleSheet \
	  -u -o ${DESTDIR}/$@ $< db2html.xsl \
	  highlight.source=1

%.noext.html : %.xml
	[ -d ${DESTDIR} ] || mkdir -p ${DESTDIR}
	xsltproc --xinclude --nonet -o ${DESTDIR}/$@ \
			--stringparam highlight.source 1 \
			--stringparam xslthl.config /usr/share/xml/docbook/stylesheet/docbook-xsl/highlighting/xslthl-config.xml \
			--param use.extensions 0 \
			--stringparam  paper.type A4 \
			db2html.xsl $<

validate: check

check:
	xmllint --xinclude --nonet --noout --postvalid $(SRCS)

clean:
	rm -f ${DESTDIR}/*.html ${DESTDIR}/*.png

.PHONY: all check clean html validate
			]]>
			</screen>
			<para>生成html</para>
			<screen>
cp  /usr/share/doc/docbook-xsl-saxon/examples/db2html.xsl 。

make html
			</screen>
		</section>
	</section>

	<section id="xmllint">
		<title>XML 校验</title>
		<screen>
$ xmllint book.xml
		</screen>
	</section>

	<section id="docbook.pdf">
		<title>PDF</title>
		<screen>
sudo apt-get install docbook-xml docbook-xsl xsltproc fop
		</screen>
		<para>安装字体</para>
		<screen>
sudo mkdir /usr/share/fonts/microsoft
		</screen>
		<para>将 C:\Windows\Fonts 目录中的字体复制到 /usr/share/fonts/microsoft </para>
		<screen>
$ java -cp /usr/share/java/fop.jar  org.apache.fop.fonts.apps.TTFReader /usr/share/fonts/microsoft/simhei.ttf simhei.xml
$ java -cp /usr/share/java/fop.jar  org.apache.fop.fonts.apps.TTFReader -ttcname "SimSun" /usr/share/fonts/microsoft/simsun.ttc simsun.xml
		</screen>

		<screen>
		<![CDATA[
sudo vim /usr/share/xml/docbook/stylesheet/docbook-xsl/fo/param.xsl
<xsl:param name="callout.unicode.font">simsun</xsl:param>
<xsl:param name="symbol.font.family">simsun</xsl:param>
<xsl:param name="callout.unicode.font">simsun</xsl:param>
		]]>
		</screen>
		<!--
<xsl:param name="body.font.family"></xsl:param>
<xsl:param name="title.font.family"></xsl:param>
		 -->
		 <screen>
		 <![CDATA[
$ vim fop.conf

<?xml version="1.0"?>
<fop version="1.0">
<base>.</base>

<renderers>
	<renderer mime="application/pdf">
     <filterList>
         <value>flate</value>
     </filterList>
      <fonts>
        <font metrics-url="simhei.xml" kerning="yes" embed-url="/usr/share/fonts/microsoft/simhei.ttf">
          <font-triplet name="simhei" style="normal" weight="normal"/>
          <font-triplet name="simhei" style="normal" weight="bold"/>
          <font-triplet name="simhei" style="italic" weight="normal"/>
          <font-triplet name="simhei" style="italic" weight="bold"/>
          </font>
          <font metrics-url="simsun.xml" kerning="yes" embed-url="/usr/share/fonts/microsoft/simsun.ttc">
          <font-triplet name="simsun" style="normal" weight="normal"/>
          <font-triplet name="simsun" style="normal" weight="bold"/>
          <font-triplet name="simsun" style="italic" weight="normal"/>
          <font-triplet name="simsun" style="italic" weight="bold"/>
          </font>
        </fonts>
    </renderer>
</renderers>
</fop>
		 ]]>
		 </screen>
		<screen>
xsltproc -o helloworld.fo /usr/share/xml/docbook/stylesheet/docbook-xsl/fo/docbook.xsl helloworld.xml
fop -c fop.conf helloworld.fo -pdf helloworld.pdf
		</screen>
	</section>
	<section id="chm">
		<title>CHM</title>
		<para>下载<ulink url="http://download.microsoft.com/download/0/a/9/0a939ef6-e31c-430f-a3df-dfae7960d564/htmlhelp.exe">HTML Help Wordshop</ulink>工具，并安装</para>
		<screen>
copy “c:\Program Files\HTML Help Workshop\hhc.exe” d:\docbook\example
xsltproc –xinclude docbook_chm.xsl docbook.xml
hhc.exe htmlhelp.hhp
		</screen>
		<screen>
		<![CDATA[
set PATH=C:\Program Files (x86)\HTML Help Workshop;%PATH%
hhc htmlhelp.hhp		
		]]>
		</screen>
	</section>
	<section id="docbook2odf">
		<title>docbook2odf - Convert docbook document to Oasis Open Document</title>
		<screen>
sudo apt-get install docbook2odf
		</screen>
		<screen>
docbook2odf book.xml
		</screen>
	</section>

	&chapter.docbook-website.xml;
	&chapter.docbook.epub.xml;

</chapter>

	&chapter.docbook.doctype.xml;
	&chapter.docbook.book.xml;
	&chapter.docbook.part.xml;
</part>