<?xml version="1.0" encoding="UTF-8"?>
<!-- $Id: chapter.docbook.doctype.xml 465 2012-09-18 07:42:15Z netkiller $ -->
<chapter id="doctype">
	<title>DOCTYPE</title>
	<section id="doctype.system">
		<title>SYSTEM</title>
		<para>在线引用DOCTYPE头，这样在创建文档的时候速度会比较慢。</para>
		<programlisting>
		<![CDATA[
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook V5.0//EN"
"http://www.oasis-open.org/docbook/xml/5.0/docbook.dtd">
		]]>
		</programlisting>
		<para>我们也可使使用本地的DTD文件</para>
		<programlisting>
		<![CDATA[
<!DOCTYPE subject SYSTEM "/usr/share/xml/docbook/schema/dtd/4.5/docbookx.dtd" [
	<!ENTITY book.info.author.xml			SYSTEM "../common/book.info.author.xml">
	<!ENTITY book.info.legalnotice.xml		SYSTEM "../common/book.info.legalnotice.xml">
	<!ENTITY book.info.abstract.xml			SYSTEM "../common/book.info.abstract.xml">
    <!ENTITY book.preface.xml           	SYSTEM "../common/book.preface.xml">
	<!ENTITY preface.about.me.xml       	SYSTEM "../common/about.me.xml">

	<!ENTITY chapter.docbook 			 	SYSTEM "chapter.docbook.xml">
	<!ENTITY chapter.docbook.doctype.xml 	SYSTEM "chapter.docbook.doctype.xml">
	<!ENTITY chapter.docbook.list.xml	 	SYSTEM "chapter.docbook.list.xml">
	<!ENTITY chapter.docbook.paragraphs.xml	SYSTEM "chapter.docbook.paragraphs.xml">
	<!ENTITY chapter.docbook.admonition.xml	SYSTEM "chapter.docbook.admonition.xml">
	<!ENTITY chapter.docbook-website.xml	SYSTEM "chapter.docbook-website.xml">
	<!ENTITY chapter.docbook.epub.xml	 	SYSTEM "chapter.docbook.epub.xml">
]>
		]]>
		</programlisting>
		<programlisting>
		<![CDATA[
<!DOCTYPE article PUBLIC "-//FreeBSD//DTD DocBook XML V4.5-Based Extension//EN" "../../../share/xml/freebsd45.dtd">
		]]>
		</programlisting>
	</section>
	<section id="stringparam">
		<title>Docbook参数</title>
		<para>/usr/share/xml/docbook/stylesheet/nwalsh/xhtml/param.xsl</para>
		<screen>
		<![CDATA[
默认HTML格式输出文件中的章内小节是没有自动编号功能的，如果要实现小节自动编号需要设置HTML格式的两个转换参数。

section.autolabel参数为1代表章内小节可自动编号，为0表示不会自动编号；

section.label.includes.component.label参数为1表示章内小节编号包含章节编号,为0表示不包含章节编号。

设置这两个参数可通过命令行方式，也可通过修改XSL转换文件方法。下面分别介绍这两种方法：

通过命令行方式：

$ xsltproc --stringparam  section.autolabel 1 \
           --stringparam  section.label.includes.component.label 1 \
           docbook.xsl  myfile.xml>myfile.htm
修改XSL转换文件方式：

DocBook文档的HTML格式转换样式文件一般位于/usr/share/sgml/docbook/docbook-xsl-1.65.1/html/目录下。通过查看docbook.xsl文件可知，在docbook.xsl中引用param.xsl作为参数设置文件，所有的参数都在这里设置。我们打开param.xsl文件，找到以下两行，再把参数置成1就可以了。

<xsl:param name="section.autolabel" select="1"/>
<xsl:param name="section.label.includes.component.label" select="1"/>
		]]>
		</screen>
		<para>另一种方法</para>
		<screen>
		<![CDATA[
cat my_docbook.xsl
<?xml version='1.0'?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                version='1.0'>
<xsl:include href="/usr/share/xml/docbook/stylesheet/nwalsh/html/docbook.xsl"/>
<xsl:output method="html"
            encoding="UTF-8"
            indent="no"/>
</xsl:stylesheet>

xsltproc -o docbook.html my_docbook.xsl docbook.xml
		]]>
		</screen>
		<section>
			<title>字符集</title>
			<screen>
--stringparam chunker.output.encoding UTF-8
			</screen>
		</section>
		<section>
			<title>Filename prefix</title>
			<screen>
			<![CDATA[
base.dir parameter value	Description	Example 					chunk filename
base.dir="htmlout/"			Output directory only.					htmlout/chap1.html
base.dir="refbook-"			Filename prefix only.					refbook-chap1.html
base.dir="htmlout/refbook-"	Output directory and filename prefix.	htmlout/refbook-chap1.html
			]]>
			</screen>
			<para>base.dir parameter</para>
			<screen>
xsltproc --stringparam base.dir /usr/apache/htdocs/ chunk.xsl myfile.xml
			</screen>
		</section>
	</section>
	<section id="docbookx.dtd">
		<title>DTD 引用</title>
		<section>
			<title>引用本地DTD</title>
			<screen>
			<![CDATA[
<!DOCTYPE subject SYSTEM "/usr/share/xml/docbook/schema/dtd/4.5/docbookx.dtd" [
...
]>
			]]>
			</screen>
		</section>
		<section>
			<title>oasis-open.org</title>
			<screen>
			<![CDATA[
<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V5.0//EN" "http://www.oasis-open.org/docbook/xml/5.0b5/dtd/docbook.dtd" [
...
]>
			]]>
			</screen>
		</section>
	</section>
	<section id="article">
		<title>article</title>
		<example>
			<title>article</title>
			<programlisting>
			<![CDATA[
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook V4.1//EN">

<article>
  <articleinfo>
    <title>An example article</title>

    <author>
      <firstname>Your first name</firstname>
      <surname>Your surname</surname>
      <affiliation>
        <address><email>foo@example.com</email></address>
      </affiliation>
    </author>

    <copyright>
      <year>2000</year>
      <holder>Copyright string here</holder>
    </copyright>

    <abstract>
      <para>If your article has an abstract then it should go here.</para>
    </abstract>
  </articleinfo>

  <sect1>
    <title>My first section</title>

    <para>This is the first section in my article.</para>

    <sect2>
      <title>My first sub-section</title>

      <para>This is the first sub-section in my article.</para>
    </sect2>
  </sect1>
</article>
			]]>
			</programlisting>
		</example>
	</section>
	<section id="book">
		<title>book</title>
		<example>
			<title>book</title>
			<programlisting>
			<![CDATA[
<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook V4.1//EN">

<book>
  <bookinfo>
    <title>An Example Book</title>

    <author>
      <firstname>Your first name</firstname>
      <surname>Your surname</surname>
      <affiliation>
        <address><email>foo@example.com</email></address>
      </affiliation>
    </author>

    <copyright>
      <year>2000</year>
      <holder>Copyright string here</holder>
    </copyright>

    <abstract>
      <para>If your book has an abstract then it should go here.</para>
    </abstract>
  </bookinfo>

  <preface>
    <title>Preface</title>

    <para>Your book may have a preface, in which case it should be placed
      here.</para>
  </preface>

  <chapter>
    <title>My first chapter</title>

    <para>This is the first chapter in my book.</para>

    <sect1>
      <title>My first section</title>

      <para>This is the first section in my book.</para>
    </sect1>
  </chapter>
</book>
			]]>
			</programlisting>
		</example>
	</section>

	<section id="include">
		<title>include</title>
		<programlisting>
		<![CDATA[
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V5.0//EN"
	"http://www.oasis-open.org/docbook/xml/5.0b5/dtd/docbook.dtd" [

	<!ENTITY chapter.database SYSTEM "chapter.database.xml">
]>
<book xml:base="http://netkiller.mefound.com/book/publish/"
	xmlns="http://docbook.org/ns/docbook" xml:lang="zh-cn">
	<info>
		<title>Netkiller Document 手札</title>
		<author>
			<firstname>netkiller</firstname>
			<surname>Neo Chan</surname>
			<affiliation>
				<address>
					<email>openunix(at)163(dot)com</email>
				</address>
			</affiliation>
		</author>
		<copyright>
			<year>2008</year>
			<holder>Copyright netkiller</holder>
		</copyright>
		<releaseinfo>
			<para>修订版本 2008-5-24</para>
		</releaseinfo>

		<abstract>
			<title></title>
			<para></para>
		</abstract>
	</info>

	<preface>
		<title></title>
		<para></para>
	</preface>

	&chapter.database;

</book>
		]]>
		</programlisting>
		<para>chapter.database.xml</para>
		<programlisting>
		<![CDATA[
<chapter>
	<title>Chapter 1</title>
</chapter>
		]]>
		</programlisting>
	</section>

	&chapter.docbook.html.xml;

</chapter>
